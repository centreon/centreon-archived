=========================
Gestion de la supervision
=========================

*********************
Acquitter un problème
*********************

Principe
========

Lorsqu'un hôte ou un service présente un incident et que ce dernier est validé, le processus de notification est enclenchée pouvant générer une notification envoyée à un contact.
Si le problème persiste et suivant la configuration réalisée (relancer une notification à intervalle de temps régulier, escalade de notification) il est possible que d'autres alertes soient émises.

L'acquittement d'un incident permet de mettre stopper le processus de notification (envoi de notifications) jusqu'à ce que l'hôte ou le service retrouve un statut nominal.

Exemple d'utilisation : 

Un service est chargé de vérifier la santé des disques durs d'une baie de disque.
Un disque dur physique tombe en panne sur une baie de disque, une notification est envoyée.
L'opérateur de supervision acquitte le service en précisant qu'une équipe est en train de régler le problème.
Les notifications ne sont plus envoyées. Le service reprendra son état nominal après changement du disque.

.. note::
    L'acquittement d'un incident signifi la prise en compte du problème par un utilisateur de la supervision (et non la résolution de ce dernier qui ne pourra être effective que lorsque le contrôle sera revenu dans son état nominal).

Pratique
========

Pour acquitter un incident, deux solutions sont possibles :

Depuis la supervision temps réelle
----------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les objets que vous souhaitez acquitter
#. Dans le menu **Plus d'actions** cliquez sur **Hôtes : Acquitter** ou sur **Services : Acquitter**

La fenêtre suivante s'affiche :

.. image :: /images/guide_exploitation/acknowledged.png
   :align: center

[TODO refaire capture avec nouvelle traduction fr]

* Si la case **Acquittement persistant en cas de changement de statut non-OK** est cochée, alors l'acquittement sera conservé en cas de changement de statut non-OK (Exemple DOWN à UNREACHABLE ou bien WARNING à CRITICAL). Sinon l'acquittement disparait et le processus de notification est réactivé.
* Si la case **Notifier** est cochée alors une notification est envoyée aux contacts liés à l'objet pour les avertir que l'incident sur la ressource a été acquitté (dans le cas où le contact possède le filtre de notification d'acquittement d'activé).
* Si la case **Persistant en cas de redémarrage de l'ordonnanceur** est cochée, alors l'acquittement sera conservé en cas de redémarrage de l'ordonannceur. Sinon l'acquittement disparait et le processus de notification est réactivé.
* Le champ **Commentaire** est généralement utilisé pour fournir la raison de l'acquittement et est obligatoire.
* Si la case **Acquitter les services liés à l'hôte** est cochée alors tous les services liés à l'hôte seront acquittés (option visible uniquement si vous acquittez un hôte).
* Si la case **Forcer les contrôles actifs** est cochée alors une commande sera envoyée à l'ordonnanceur pour recontrôler dans les plus brefs délais la ressource.

Pour supprimer l'acquittement d'un incident sur un objet :

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez les objets auxquels vous souaitez supprimer l'acquittement
#. Dans le menu **Plus d'actions** cliquez sur **Hôtes : Dés-acquitter** ou sur **Services : Dés-acquitter**

Depuis la fiche détaillée d'un objet
------------------------------------

A partir de la page de détail d'un objet, cliquer sur l'icône |enabled| associé au champ **Acquittés** dans le cadre **Options**

Vous accèderez à une page dédiée permettant d'acquitter l'incident.

.. note::
    Les champs sont identiques à la fenêtre obtenue à partir du menu de supervision temps réel.

**********************
Ajouter un commentaire
**********************

Principe
========

Centreon permet d'ajouter des commentaires à un objet. Ce commentaire est visible par toute personne ayant accès à la ressource (hôte ou service).
Un commentaire possède les propriétés suivantes :

* Nom de l'hôte
* Nom du service si le commentaire est associé à un service
* Date de saisie du commentaire
* Auteur du commentaire
* Le contenu du commentaire
* La validité du commentaire face à un redémarrage de l'ordonnanceur

Pratique
========

Pour ajouter un commentaire, deux solutions sont possibles :

Depuis la fiche détaillée d'un objet
------------------------------------

#. Accéder à la page de détails de l'objet
#. Dans la catégorie **Commandes disponibles** cliquez sur **Ajouter un commentaire pour cet hôte/ce service**

Depuis le menu Commentaires
------------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Dans le menu de gauche, sous **Moteur de supervision**, cliquez sur **Commentaires**
#. Cliquez sur **Ajouter un commentaire**

Attributs
---------

La fenêtre suivante s'affiche :

.. image :: /images/guide_exploitation/comment.png
   :align: center

[TODO refaire capture avec nouvelle traduction fr]

* Le champ **Nom de l'hôte** définit l'hôte concerné par le commentaire
* Si vous avez choisit d'ajouter un commentaire pour un service, le champ **Service** vous permet de sélectionner le service concerné par le commentaire.
* Si la case **Persistant en cas de redémarrage de l'ordonnanceur** est cochée, alors le commentaire sera conservé en cas de redémarrage de l'ordonannceur.
* Le champ **Commentaire** contient le commentaire lui-même.

***************************
Programmer un temps d'arrêt
***************************

Principe
========

Un temps d'arrêt est une période de temps durant laquelle les notifications sont désactivées pour une ressource .
Les temps d'arrêts sont utilises lors d'opération d'une maintenance programmée, ils permettent d'éviter de recevoir des alertes de type faux-positif.

.. note::
    Il est important de sélectionner l'ensemble des ressoruces nécessaires afin d'éviter les faux positifs comme les faux-négatifs. De plus, le temps passé dans cet état est pris en compte lors de la génération des données de disponibilité.

Il existe deux types de temps d'arrêts :

* Le temps d'arrêt **fixe** : il démarre et s'arrête à l'heure prévue.
* Le temps d'arrêt **flexible** : il démarrera pendant la fenêtre de temps prévue dès la détection d'un incident et prendra fin lorsque la durée prévue en secondes sera écoulée.

Pratique
========

Il y a trois possibilités différentes de définir un temps d'arrêt :

* Depuis la fiche de détails d'un hôte ou du service
* Depuis l'interface de supervision temps réelle
* Depuis le menu **Temps d'arrêt**

Depuis la fiche détaillée d'un objet
------------------------------------

#. Accéder à la page de détails d'un objet
#. Dans la catégorie **Commandes** cliquez sur **Planifier un arrêt pour cet hôte/ce service**

Depuis la supervision temps réelle
----------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le(s) objet(s) sur lesquels vous souhaitez planifier un temps d'arrêt
#. Dans le menu **Plus d'actions...** cliquez sur **Hôtes : Planifier un temps d'arrêt** ou **Services : Planifier un temps d'arrêt**

Depuis le menu Temps d'arrêt
----------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Dans le menu de gauche, sous **Moteur de supervision**, cliquez sur **Temps d'arrêt**
#. Cliquez sur **Ajouter un temps d'arrêt**

Attributs
---------

* Le champ **Nom de l'hôte** définit l'hôte concerné par le temps d'arrêt
* Le champ **Service** définit le service concerné par le temps d'arrêt
* Si la case **Fixe** est cochée alors le temps d'arrêt est fixe. Sinon, il est flexible
* Si le temps d'arrêt est flexible, le champ **Durée** définit la durée du temps d'arrêt
* Les champs **Date et heure de début** et **Date et heure de fin** définissent les dates de début et de fin du temps d'arrêt
* Le champ **Commentaires** sert à indiquer pourquoi le temps d'arrêt est programmé

*************************
Gestion des vérifications
*************************

Principe
========

Il est possible d'activer ou de désactiver momentanément la vérification d'un hôte ou d'un service.

.. warning::
    La modification des paramètres de vérifications n'impacte pas la configuration de l'objet en base de données. Ces modifications sont réalisées sur la supervision en temps-réel, elles seront annulées lors du redémarrage de l'ordonnacneur.

Pratique
========

Pour modifier la gestino de la vérification sur un objet, deux solutions sont possibles :

Depuis la fiche détaillée d’un objet
------------------------------------

#. Accéder à la page de détails de l'objet
#. Dans la catégorie **Options**, rendez-vous à la ligne **Contrôles actifs** pour vérifier l'état des contrôles. 

Pour : 

* Désactiver la vérification, cliquez sur |disabled|
* Activer la vérification, cliquez sur |enabled|

Depuis la supervision temps réelle
----------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le(s) objet(s) sur lesquels vous souhaitez activer ou de désactiver la vérification
#. Dans le menu **Plus d'actions...** cliquez sur :

* **Hôtes : Désactiver la vérification** ou **Services : Désactiver la vérification** pour arrêter la vérification d'un hôte ou d'un service
* **Hôtes : Activer la vérification** ou **Services : Activer la vérification** pour activer la vérification d'un hôte ou d'un service

*********************
Soumettre un résultat
*********************

Principe
========

Pour les services ayant la propriété de contrôle **passif**, il est possible d'envoyer manuellement un résultat à l'ordonnanceur 
afin que celui-ci soit pris en compte par l'ordonnanceur.

Pratique
========

Pour soumettre un résultat, accéder à la page de détails de l'objet. Dans la catégorie **Commandes du service** cliquez sur **Soumettre un résultat pour ce service**

Attributs
---------

* Les champs **Nom de l'hôte** et **Service** définissent l'hôte et le service pour lequel le résultat sera soumit
* Le champ **Résultat du contrôle** définit le statut du service
* Le champ **Sortie du contrôle** définit le message à afficher pour le service
* Le champ **Données de performance** permet de définir des données de performances pour la génération des graphiques

*************************
Gestion des notifications
*************************

Principe
========

Il est possible d'activer ou de désactiver momentanément la notification d'un hôte ou d'un service.

.. warning::
    La modification des paramètres de notifications n'impacte pas la configuration de l'objet en base de données. Ces modifications sont réalisées sur la supervision en temps-réel, elles seront annulées lors du redémarrage de l’ordonnacneur.

Pratique
========

Il y a deux moyens de gérer les notifications :

Depuis la fiche détaillée d'un objet
------------------------------------

#. Accéder à la page de détails de l'objet
#. Dans la catégorie **Options**, rendez-vous à la ligne **Notifications** pour l'envoi des notifications. 

Pour : 

* Désactiver la notification, cliquez sur |disabled|
* Activer la notification, cliquez sur |enabled|

Depuis la supervision temps réelle
----------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les hôtes/services pour lesquels vous souhaitez activer ou de désactiver la notification
#. Dans le menu **Plus d'actions...** cliquez sur :

* **Hôtes : Désactiver la notification** ou **Services : Désactiver la notification** pour arrêter la notification d'un hôte ou d'un service
* **Hôtes : Activer la notification** ou **Services : Activer la notification** pour activer la notification d'un hôte ou d'un service

*****************************
Reprogrammation des contrôles
*****************************

Principe
========

Par défaut, les contrôles (vérifications d'un service) sont exécutés à intervalle régulier suivant la configuration définie par l'utilisateur.
Il est possibel d'intérragir sur la pile d'ordonnancement des contrôles afin de modifier la programmation de ces derniers.

Il existe deux types de programmation :

* La programmation classique : la vérification du service est mise en priorité dans la file d'attente de l'ordonnacneur (dès que possible).
* La programmation forcée : la vérification du service est mise en priorité dans la file d'attente de l'ordonnacneur (dès que possible) et cela même si l'heure de la demande d'exécution est en dehors de la période contrôle ou si le service n'est pas de type actif.

Pratique
========

Il y a deux moyens de forcer la vérification d'un service :

Depuis la fiche détaillée de l'objet
------------------------------------

#. Accéder à la page de détail de l'objet
#. Dans la catégorie **Commandes de l'hôte** (ou **Commandes du service**), cliquez sur **Re-planifier le prochain contrôle pour cet hôte /  service** ou **Re-planifier le prochain contrôle pour cet hôte / ce service (Forcé)**

Depuis la supervision temps réelle
----------------------------------

#. Rendez-vous dans le menu **Supervision** ==> **Hôtes** (ou **Services**)
#. Sélectionnez le ou les objets pour lesquels vous souhaitez forcer la vérification
#. Dans le menu **Plus d'actions...** cliquez sur **Planifier un contrôle immédiat** ou **Planifier un contrôle immédiat (Forcé)**

.. |enabled|    image:: /images/enabled.png
.. |disabled|    image:: /images/disabled.png
