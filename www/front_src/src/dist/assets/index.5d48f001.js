var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,r=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,o)=>{for(var i in o||(o={}))t.call(o,i)&&r(e,i,o[i]);if(a)for(var i of a(o))n.call(o,i)&&r(e,i,o[i]);return e},i=(e,t,a)=>(r(e,"symbol"!=typeof t?t+"":t,a),a);import{r as l,T as s}from"./vendor.ecb5856a.js";import{n as c,a_ as m,bb as p}from"./index.eda796bc.js";import{s as d,B as h,P as u}from"./baseWizard.5f66a05d.js";import{R as b,I as v,v as f}from"./validators.173067bc.js";import{S as y}from"./SelectField.b805a9da.js";import{C as S}from"./CheckboxField.c4cf3626.js";import{b as E}from"./withTranslation.73eadfaa.js";import{j as _,F as g}from"./reduxForm.9bd373e7.js";import{r as x}from"./index.15eca6ad.js";import"./hoc.a724f6b1.js";import"./utils.7b91ae49.js";import"./pick.70e729da.js";import"./isNil.943b904d.js";import"./mapValues.3c657680.js";import"./App.be5902de.js";import"./react-router-dom.a95a774c.js";class j extends l.Component{constructor(){super(...arguments),i(this,"state",{inputTypeManual:!0,initialized:!1}),i(this,"initializeFromRest",(e=>{this.props.change("inputTypeManual",!e),this.setState({initialized:!0,inputTypeManual:!e})})),i(this,"UNSAFE_componentWillReceiveProps",(e=>{const{waitList:t}=e,{initialized:a}=this.state;t&&!a&&this.initializeFromRest(t.length>0),this.setState({initialized:!0,centreon_folder:"/centreon/"})})),i(this,"handleChange",((e,t)=>{const{waitList:a,change:n}=this.props;n("server_name",a.find((e=>e.ip===t)).server_name)}))}onManualInputChanged(e){this.setState({inputTypeManual:e})}render(){const{error:e,handleSubmit:t,onSubmit:a,waitList:n,t:r}=this.props,{inputTypeManual:o}=this.state;return l.createElement("div",{className:d["form-wrapper"]},l.createElement("div",{className:d["form-inner"]},l.createElement("div",{className:d["form-heading"]},l.createElement("h2",{className:s(d["form-title"],d["mb-2"])},r("Remote Server Configuration"))),l.createElement("form",{autoComplete:"off",onSubmit:t(a)},l.createElement(g,{name:"inputTypeManual",onChange:()=>{this.onManualInputChanged(!0)},checked:o,component:b,label:r("Create new Remote Server")}),o?l.createElement("div",null,l.createElement(g,{name:"server_name",component:v,type:"text",placeholder:"",label:`${r("Server Name")}:`,validate:f(r)}),l.createElement(g,{name:"server_ip",component:v,type:"text",placeholder:"",label:`${r("Server IP address")}:`,validate:f(r)}),l.createElement(g,{name:"db_user",component:v,type:"text",placeholder:"",label:`${r("Database username")}:`,validate:f(r)}),l.createElement(g,{name:"db_password",component:v,type:"password",placeholder:"",label:`${r("Database password")}:`,validate:f(r)}),l.createElement(g,{name:"centreon_central_ip",component:v,type:"text",placeholder:"",label:`${r("Centreon Central IP address, as seen by this server")}:`,validate:f(r)}),l.createElement(g,{name:"centreon_folder",component:v,type:"text",placeholder:"/centreon/",label:`${r("Centreon Web Folder on Remote")}:`,validate:f(r)}),l.createElement(g,{name:"no_check_certificate",component:S,label:r("Do not check SSL certificate validation")}),l.createElement(g,{name:"no_proxy",component:S,label:r("Do not use configured proxy to connect to this server")})):null,l.createElement(g,{name:"inputTypeManual",onClick:()=>{this.onManualInputChanged(!1)},checked:!o,component:b,label:`${r("Select a Remote Server")}:`}),o?null:l.createElement("div",null,n?l.createElement(g,{name:"server_ip",onChange:this.handleChange,component:y,label:`${r("Select Pending Remote Links")}:`,required:!0,options:[{disabled:!0,selected:!0,text:r("Select IP"),value:""}].concat(n.map((e=>({value:e.ip,text:e.ip}))))}):null,l.createElement(g,{name:"server_name",component:v,type:"text",placeholder:"",label:`${r("Server Name")}:`,validate:f(r)}),l.createElement(g,{name:"db_user",component:v,type:"text",placeholder:"",label:`${r("Database username")}:`,validate:f(r)}),l.createElement(g,{name:"db_password",component:v,type:"password",placeholder:"",label:`${r("Database password")}:`,validate:f(r)}),l.createElement(g,{name:"centreon_central_ip",component:v,type:"text",placeholder:"",label:`${r("Centreon Central IP address, as seen by this server")}:`,validate:f(r)}),l.createElement(g,{name:"centreon_folder",component:v,type:"text",placeholder:"/centreon/",label:`${r("Centreon Web Folder on Remote")}:`,validate:f(r)}),l.createElement(g,{name:"no_check_certificate",component:S,label:r("Do not check SSL certificate validation")}),l.createElement(g,{name:"no_proxy",component:S,label:r("Do not use configured proxy to connect to this server")})),l.createElement("div",{className:d["form-buttons"]},l.createElement("button",{className:d.button,type:"submit"},r("Next"))),e?l.createElement("div",{className:d["error-block"]},e.message):null)))}}var w=E()(_({form:"RemoteServerFormStepOne",enableReinitialize:!0,destroyOnUnmount:!1,keepDirtyOnReinitialize:!0})(j));class C extends l.Component{constructor(){super(...arguments),i(this,"links",[{active:!0,prevActive:!0,number:1,path:x.serverConfigurationWizard},{active:!0,number:2,path:x.remoteServerStep1},{active:!1,number:3},{active:!1,number:4}]),i(this,"state",{waitList:null}),i(this,"wizardFormWaitListApi",m("internal.php?object=centreon_configuration_remote&action=getWaitList")),i(this,"getWaitList",(()=>{this.wizardFormWaitListApi.post().then((e=>{this.setState({waitList:e.data})})).catch((()=>{this.setState({waitList:[]})}))})),i(this,"componentDidMount",(()=>{this.getWaitList()})),i(this,"handleSubmit",(e=>{const{history:t,setPollerWizard:a}=this.props;a(e),t.push(x.remoteServerStep2)}))}render(){const{links:e}=this,{pollerData:t}=this.props,{waitList:a}=this.state;return l.createElement(h,null,l.createElement(u,{links:e}),l.createElement(w,{waitList:a,initialValues:o(o({},t),{centreon_folder:"/centreon/"}),onSubmit:this.handleSubmit.bind(this)}))}}var L=c((({pollerForm:e})=>({pollerData:e})),{setPollerWizard:p})(C);export default L;
