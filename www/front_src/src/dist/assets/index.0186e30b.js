var e=Object.defineProperty,t=(t,a,n)=>(((t,a,n)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n})(t,"symbol"!=typeof a?a+"":a,n),n);import{r as a}from"./vendor.ecb5856a.js";import{n,a_ as i,bb as r}from"./index.eda796bc.js";import{s,B as l,P as o}from"./baseWizard.5f66a05d.js";import{R as m,I as p,v as c}from"./validators.173067bc.js";import{S as d}from"./SelectField.b805a9da.js";import{b as u}from"./withTranslation.73eadfaa.js";import{j as h,F as b}from"./reduxForm.9bd373e7.js";import{r as v}from"./index.15eca6ad.js";import"./hoc.a724f6b1.js";import"./utils.7b91ae49.js";import"./pick.70e729da.js";import"./isNil.943b904d.js";import"./mapValues.3c657680.js";import"./App.be5902de.js";import"./react-router-dom.a95a774c.js";class f extends a.Component{constructor(){super(...arguments),t(this,"state",{inputTypeManual:!0,initialized:!1}),t(this,"initializeFromRest",(e=>{const{change:t}=this.props;t("inputTypeManual",!e),this.setState({initialized:!0,inputTypeManual:!e})})),t(this,"UNSAFE_componentWillReceiveProps",(e=>{const{waitList:t}=e,{initialized:a}=this.state;t&&!a&&this.initializeFromRest(t.length>0),this.setState({initialized:!0})})),t(this,"handleChange",((e,t)=>{const{waitList:a,change:n}=this.props;n("server_name",a.find((e=>e.ip===t)).server_name)}))}onManualInputChanged(e){this.setState({inputTypeManual:e})}render(){const{error:e,handleSubmit:t,onSubmit:n,waitList:i,t:r}=this.props,{inputTypeManual:l}=this.state;return a.createElement("div",{className:s["form-wrapper"]},a.createElement("div",{className:s["form-inner"]},a.createElement("div",{className:s["form-heading"]},a.createElement("h2",{className:s["form-title"]},r("Server Configuration"))),a.createElement("form",{autoComplete:"off",onSubmit:t(n)},a.createElement(b,{name:"inputTypeManual",onChange:()=>{this.onManualInputChanged(!0)},checked:l,component:m,label:r("Create new Poller")}),l?a.createElement("div",null,a.createElement(b,{name:"server_name",component:p,type:"text",placeholder:"",label:`${r("Server Name")}:`,validate:c(r)}),a.createElement(b,{name:"server_ip",component:p,type:"text",placeholder:"",label:`${r("Server IP address")}:`,validate:c(r)}),a.createElement(b,{name:"centreon_central_ip",component:p,type:"text",placeholder:"",label:`${r("Centreon Central IP address, as seen by this server")}:`,validate:c(r)})):null,a.createElement(b,{name:"inputTypeManual",onClick:()=>{this.onManualInputChanged(!1)},checked:!l,component:m,label:`${r("Select a Poller")}:`}),l?null:a.createElement("div",null,i?a.createElement(b,{name:"server_ip",onChange:this.handleChange,component:d,label:`${r("Select Pending Poller IP")}:`,required:!0,options:[{disabled:!0,selected:!0,text:r("Select IP"),value:""}].concat(i.map((e=>({value:e.ip,text:e.ip}))))}):null,a.createElement(b,{name:"server_name",component:p,type:"text",placeholder:"",label:`${r("Server Name")}:`,validate:c(r)}),a.createElement(b,{name:"server_ip",component:p,type:"text",placeholder:"",label:`${r("Server IP address")}:`,validate:c(r)}),a.createElement(b,{name:"centreon_central_ip",component:p,type:"text",placeholder:"",label:`${r("Centreon Central IP address, as seen by this server")}:`,validate:c(r)})),a.createElement("div",{className:s["form-buttons"]},a.createElement("button",{className:s.button,type:"submit"},r("Next"))),e?a.createElement("div",{className:s["error-block"]},e.message):null)))}}var S=u()(h({form:"PollerFormStepOne",enableReinitialize:!0,destroyOnUnmount:!1,keepDirtyOnReinitialize:!0})(f));class E extends a.Component{constructor(){super(...arguments),t(this,"links",[{active:!0,prevActive:!0,number:1,path:v.serverConfigurationWizard},{active:!0,number:2,path:v.pollerStep1},{active:!1,number:3},{active:!1,number:4}]),t(this,"state",{error:null,waitList:null}),t(this,"wizardFormWaitListApi",i("internal.php?object=centreon_configuration_remote&action=getPollerWaitList")),t(this,"getWaitList",(()=>{this.wizardFormWaitListApi.post().then((e=>{this.setState({waitList:e.data})})).catch((()=>{this.setState({waitList:[]})}))})),t(this,"componentDidMount",(()=>{this.getWaitList()})),t(this,"handleSubmit",(e=>{const{history:t,setPollerWizard:a}=this.props;a(e),t.push(v.pollerStep2)}))}render(){const{links:e}=this,{waitList:t}=this.state;return a.createElement(l,null,a.createElement(o,{links:e}),a.createElement(S,{onSubmit:this.handleSubmit.bind(this),initialValues:{},waitList:t}))}}var y=n((({pollerForm:e})=>({pollerData:e})),{setPollerWizard:r})(E);export default y;
